<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="ja" lang="ja" dir="ltr">
<head>
	<title>日本PHPユーザ会 掲示板: PHP事はじめ &raquo; 助けてください！</title>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
	<meta name="description" content="日本PHPユーザ会運営の掲示板です。※ただいまテスト運用中です。" />
	<meta name="keywords" content="php,web,php.gr.jp,community,usebb" />
	<link rel="stylesheet" type="text/css" href="./templates/phpgrjp0.3/styles.css" />
	<link rel="shortcut icon" href="./templates/phpgrjp0.3/gfx/usebb.ico" />
	<link rel="alternate" type="application/rss+xml" title="日本PHPユーザ会 掲示板 RSS フィード" href="rss.xml" />
	<script type="text/javascript" src="sources/javascript.js"></script>
</head>
<body onload="javascript:init_external()">
	<div id="pagebox-bg">
	<div id="shadow-left">
	<div id="shadow-right">
	
	<p id="logo"><a href="index.html"><img src="./templates/phpgrjp0.3/gfx/usebb.png" alt="UseBB" title="ホーム" /></a></p>
	<h1 id="boardname"><span id="line">日本PHPユーザ会 掲示板</span></h1>
	<h2 id="boarddescr">日本PHPユーザ会運営の掲示板です。※ただいまテスト運用中です。</h2>
	
	<div id="topmenu"><ul>
		<li><a href="index.html">ホーム</a></li><li><a href="faq.html">FAQ</a></li><li><a href="active.html">活発なトピック</a></li>
	</ul></div>
	<div id="topmenu-shadow"></div>
	
	<p class="locationbar">
		&bull; <a href="index.html">日本PHPユーザ会 掲示板</a> &raquo; <a href="forum-2.html">PHP事はじめ</a> &raquo; 助けてください！
	</p>

	<h3 id="forumname"><a href="topic-193.html">助けてください！</a></h3>
	<p id="forummods"></p>
	<p id="toolbartop"> </p>
	<p id="pagelinkstop">ページ: 1</p>
	<table class="maintable">
		<tr>
			<th>投稿者</th>
			<th>投稿</th>
		</tr>

		<tr class="tr1">
			<td class="postername">
				<div class="posternamecontainer"><a href="profile-303.html">criskeiichi</a></div>
			</td>
			<td class="postinfo">
				<div class="postlinks"></div>
				<div class="postdate"><a href="topic-post527.html#post527" name="post527" rel="nofollow">#1</a> 2010 年 2 月 13 日(土) 0:08</div>
			</td>
		</tr>
		<tr class="tr1">
			<td class="posterinfo">
				会員
				<div class="avatar"></div>
				<div class="field">登録者: 2 2010</div>
				<div class="field">返信数: 4</div>
				<div class="field"></div>
			</td>
			<td class="postcontent">
				<div class="post">もうダメです。<br />とてもカンタンなフォームみたいですが、<br />件名だけはちゃんと日本語になりません。<br /><br />ファイルは三つです。<br /><br /><br />①　mail1.html<br /><br />\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\<br /><br />&lt;?php<br />session_start();<br /><br />if(isset(&#36;_POST))<br />&#123;<br />	if(isset(&#36;_POST[&quot;add&quot;]))<br />	&#123;<br />		&#36;_SESSION[&quot;name&quot;] = &#36;_POST[&quot;name&quot;];<br />		&#36;_SESSION[&quot;email&quot;] = &#36;_POST[&quot;email&quot;];                                     <br /> 		&#36;_SESSION[&quot;place5&quot;] = &#36;_POST[&quot;place5&quot;];       <br />		header(&quot;location: mail1_confirm.html&quot;);<br />	&#125;<br />	if(isset(&#36;_POST[&quot;clear&quot;]))<br />	&#123;<br />		&#36;_SESSION[&quot;name&quot;] = &quot;&quot;;<br />		&#36;_SESSION[&quot;email&quot;] = &quot;&quot;;        <br />		&#36;_SESSION[&quot;place5&quot;] = &quot;&quot;;                                     <br />	&#125;<br />&#125;<br /><br />?&gt;<br /><br /><br /><br /><br />&lt;!DOCTYPE html PUBLIC &quot;-//W3C//DTD XHTML 1.0 Transitional//EN&quot; &quot;http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd&quot;&gt;<br />&lt;html xmlns=&quot;http://www.w3.org/1999/xhtml&quot; lang=&quot;ja&quot; xml:lang=&quot;ja&quot;&gt;<br />&lt;head&gt;<br />&lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=utf-8&quot; /&gt;<br />&gt;<br />&lt;title&gt;フォーム&lt;/title&gt;<br /><br />&lt;!--]fontsize--&gt;<br /><br />&lt;/head&gt;<br /><br /><br />&lt;body&gt;<br />&lt;table width=&quot;100&quot; border=&quot;0&quot; cellspacing=&quot;0&quot; cellpadding=&quot;0&quot;&gt;<br />  &lt;tr&gt;<br />    &lt;td&gt;&amp;nbsp;&lt;/td&gt;<br />  &lt;/tr&gt;<br />  &lt;tr&gt;<br />    &lt;td background=&quot;img/bg.gif&quot;&gt;<br />    <br />    &lt;div style=&quot;padding:0px 30px 0px 40px&quot;&gt;<br />    <br />     &lt;form name=&quot;form1&quot; id=&quot;form1&quot; method=&quot;post&quot; action=&quot;mail1.html&quot; onSubmit=&quot;return _validation();&quot;&gt;<br />    &lt;p align=&quot;right&quot; class=&quot;style4&quot; style=&quot;margin-right:20px&quot;&gt;&amp;nbsp;&lt;/p&gt;<br />    &lt;table width=&quot;200&quot; border=&quot;0&quot; cellspacing=&quot;0&quot; cellpadding=&quot;0&quot;&gt;<br />      &lt;tr&gt;<br />        &lt;td width=&quot;2&quot; bgcolor=&quot;#175600&quot;&gt;&amp;nbsp;&lt;/td&gt;<br />        &lt;td style=&quot;padding:15px 0px 15px 10px&quot;&gt;&lt;span class=&quot;style9&quot;&gt;ォーム&lt;/span&gt;&lt;/td&gt;<br />      &lt;/tr&gt;<br />    &lt;/table&gt;<br />    &lt;p class=&quot;style3&quot;&gt;&amp;nbsp;&lt;/p&gt;<br />    &lt;table width=&quot;100%&quot; border=&quot;0&quot; cellspacing=&quot;10&quot; cellpadding=&quot;0&quot;&gt;<br />      &lt;tr&gt;<br />        &lt;td&gt;&lt;span class=&quot;style4&quot;&gt;名前：&lt;/span&gt;<br />          &lt;input type=&quot;text&quot; name=&quot;name&quot; id=&quot;name&quot; value=&quot;&lt;?php echo &#36;_SESSION[&quot;name&quot;]; ?&gt;&quot;  style=&quot;width:150px&quot;/&gt;          <br />&lt;/td&gt;<br />        &lt;/tr&gt;<br />        &lt;tr&gt;<br />        &lt;td&gt;&lt;span class=&quot;style4&quot;&gt;メール：&lt;/span&gt;<br />          &lt;input type=&quot;text&quot; name=&quot;email&quot; id=&quot;email&quot; value=&quot;&lt;?php echo &#36;_SESSION[&quot;email&quot;]; ?&gt;&quot;  style=&quot;width:150px&quot;/&gt;          <br />&lt;/td&gt;<br />        &lt;/tr&gt;      <br />        <br />    &lt;/table&gt;<br />    &lt;br /&gt;<br />    &lt;br /&gt;<br />    &lt;table width=&quot;100%&quot; border=&quot;0&quot; cellspacing=&quot;10&quot; cellpadding=&quot;0&quot;&gt;<br /><br />      &lt;tr&gt;<br />        &lt;td&gt;&lt;span class=&quot;style7&quot;&gt;コメント&lt;/span&gt;&lt;/td&gt;<br />      &lt;/tr&gt;<br />      &lt;tr&gt;<br />        &lt;td&gt;&lt;textarea  name=&quot;place5&quot; id=&quot;place5&quot; style=&quot;width:470px&quot;&gt;&lt;?php echo &#36;_SESSION[&quot;place5&quot;]; ?&gt;&lt;/textarea&gt;&lt;/td&gt;<br />      &lt;/tr&gt;<br />    &lt;/table&gt;<br />    &lt;p&gt;&lt;input type=&quot;submit&quot; name=&quot;add&quot; id=&quot;add&quot; value=&quot;確認&quot; /&gt;<br />           &lt;input type=&quot;submit&quot; name=&quot;clear&quot; id=&quot;clear&quot; value=&quot;リセット&quot; /&gt; <br />&lt;/p&gt;<br />    &lt;/form&gt;<br />     &lt;/div&gt;<br /><br />    &lt;div align=&quot;center&quot;&gt;&lt;/div&gt;&lt;/td&gt;<br />  &lt;/tr&gt;<br />  &lt;tr&gt;<br />    &lt;td&gt;&amp;nbsp;&lt;/td&gt;<br />  &lt;/tr&gt;<br />&lt;/table&gt;<br />&lt;/body&gt;<br />&lt;/html&gt;<br /><br /><br />///////////////////////////////////////////////////////////////////<br /><br />②　mail1_confirm.html<br /><br /><br /><br /><br /><br />&lt;?php<br />session_start();<br />if(&#36;_SESSION[&quot;name&quot;] == &quot;&quot;)<br />	header(&quot;location:mail1.html&quot;);<br /><br />&#36;to = &quot;username@emailserver.com&quot;;<br /><br />&#36;subject = &quot;ホームページからのメッセージ&quot;;<br />if(isset(&#36;_POST))<br />&#123;<br />	if(isset(&#36;_POST[&quot;confirm_add&quot;]))<br />	&#123;<br />		&#36;from_email = &#36;_SESSION[&quot;email&quot;];<br />		&#36;from_name = &#36;_SESSION[&quot;name&quot;];<br /><br />&#36;body = &quot;<br />┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓<br />　診察希望フォーム <br />┗━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┛<br /><br />―――――――――――――――――――――――――――――――――――――― <br />　■名前 <br />　　&quot; .&#36;_SESSION[&quot;name&quot;]. &quot; <br />―――――――――――――――――――――――――――――――――――――― <br />　■メール <br />　　&quot; .&#36;_SESSION[&quot;email&quot;]. &quot; <br />―――――――――――――――――――――――――――――――――――――― <br />　■コメント <br />　　&quot; .&#36;_SESSION[&quot;place5&quot;]. &quot; <br />―――――――――――――――――――――――――――――――――――――― <br /><br /><br />&quot;;<br />		<br />		&#36;_SESSION[&quot;name&quot;] = &quot;&quot;;<br />		&#36;_SESSION[&quot;email&quot;] = &quot;&quot;;        <br />		&#36;_SESSION[&quot;place5&quot;] = &quot;&quot;;                        <br /><br />		if(_mail(&#36;to, &#36;subject, &#36;body, &#36;from_email,&#36;from_name))<br />			header(&quot;location: mail1_result.html?res=1&quot;);<br />		else<br />			header(&quot;location: mail1_result.html?res=0&quot;);<br />					<br />	&#125;<br />	if(isset(&#36;_POST[&quot;back&quot;]))<br />	&#123;<br />		header(&quot;location: mail1.html&quot;);<br />	&#125;<br />&#125;<br /><br />function _mail(&#36;to, &#36;subject, &#36;body, &#36;from_email,&#36;from_name)<br />&#123;<br />    mb_language(&quot;ja&quot;);<br />    &#36;subject = mb_convert_encoding(&#36;subject, &quot;ISO-2022-JP&quot;,&quot;AUTO&quot;);<br />    &#36;subject = mb_encode_mimeheader(&#36;subject);<br /> <br />    &#36;from_name = mb_convert_encoding(&#36;from_name, &quot;ISO-2022-JP&quot;,&quot;AUTO&quot;);<br />    &#36;from_name = mb_encode_mimeheader(&#36;from_name);<br /> <br />    &#36;headers  = &quot;MIME-Version: 1.0 \n&quot; ;<br />    &#36;headers .= &quot;From: &quot; .<br />           &quot;&quot;.&#36;from_name .&quot;&quot; .<br />           &quot;&lt;&quot;.&#36;from_email.&quot;&gt; \n&quot;;<br />    &#36;headers .= &quot;Reply-To: &quot; .<br />           &quot;&quot;.&#36;from_name .&quot;&quot; .<br />           &quot;&lt;&quot;.&#36;from_email.&quot;&gt; \n&quot;;<br />   <br />    &#36;headers .= &quot;Content-Type: text/plain;charset=ISO-2022-JP \n&quot;;<br />    &#36;body = mb_convert_encoding(&#36;body, &quot;ISO-2022-JP&quot;,&quot;AUTO&quot;);<br />    &#36;sendmail_params  = &quot;-f&#36;from_email&quot;;<br />    &#36;result = mail(&#36;to, &#36;subject, &#36;body, &#36;headers, &#36;sendmail_params);<br />    return &#36;result;<br />&#125;<br /><br />?&gt;<br /><br /><br />&lt;!DOCTYPE html PUBLIC &quot;-//W3C//DTD XHTML 1.0 Transitional//EN&quot; &quot;http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd&quot;&gt;<br />&lt;html xmlns=&quot;http://www.w3.org/1999/xhtml&quot; lang=&quot;ja&quot; xml:lang=&quot;ja&quot;&gt;<br />&lt;head&gt;<br />&lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=utf-8&quot; /&gt;<br /><br />&lt;title&gt;フォーム&lt;/title&gt;<br /><br /><br />&lt;/head&gt;<br /><br /><br />&lt;body&gt;<br />&lt;table width=&quot;100&quot; border=&quot;0&quot; cellspacing=&quot;0&quot; cellpadding=&quot;0&quot;&gt;<br />  &lt;tr&gt;<br />    &lt;td&gt;&lt;img src=&quot;img/top.gif&quot; width=&quot;584&quot; height=&quot;43&quot; /&gt;&lt;/td&gt;<br />  &lt;/tr&gt;<br />  &lt;tr&gt;<br />    &lt;td background=&quot;img/bg.gif&quot;&gt;<br />    <br />    &lt;div style=&quot;padding:0px 30px 0px 40px&quot;&gt;<br />    <br />     &lt;form name=&quot;form1&quot; id=&quot;form1&quot; method=&quot;post&quot; action=&quot;mail1_confirm.html&quot;&gt;<br />    &lt;p align=&quot;right&quot; class=&quot;style4&quot; style=&quot;margin-right:20px&quot;&gt;&amp;nbsp;&lt;/p&gt;<br />    &lt;table width=&quot;200&quot; border=&quot;0&quot; cellspacing=&quot;0&quot; cellpadding=&quot;0&quot;&gt;<br />      &lt;tr&gt;<br />        &lt;td width=&quot;2&quot; bgcolor=&quot;#175600&quot;&gt;&amp;nbsp;&lt;/td&gt;<br />        &lt;td style=&quot;padding:15px 0px 15px 10px&quot;&gt;&lt;span class=&quot;style9&quot;&gt;フォーム&lt;/span&gt;&lt;/td&gt;<br />      &lt;/tr&gt;<br />    &lt;/table&gt;<br />    &lt;p class=&quot;style1&quot;&gt;&amp;nbsp;&lt;/p&gt;<br />    &lt;table width=&quot;100%&quot; border=&quot;0&quot; cellspacing=&quot;10&quot; cellpadding=&quot;0&quot;&gt;<br />      &lt;tr&gt;<br />        &lt;td class=&quot;style4&quot;&gt;&lt;span class=&quot;style2&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;style4&quot;&gt;名前：&lt;/span&gt;<br />          &lt;?php echo &#36;_SESSION[&quot;name&quot;]; ?&gt;<br />&lt;/td&gt;<br />        &lt;/tr&gt;<br />        <br />              &lt;tr&gt;<br />        &lt;td class=&quot;style4&quot;&gt;&lt;span class=&quot;style4&quot;&gt;メール：&lt;/span&gt;<br />          &lt;?php echo &#36;_SESSION[&quot;email&quot;]; ?&gt;&lt;/td&gt;<br />        &lt;/tr&gt;<br />    &lt;/table&gt;<br />    &lt;br /&gt;<br />    &lt;br /&gt;<br />    &lt;table width=&quot;100%&quot; border=&quot;0&quot; cellspacing=&quot;10&quot; cellpadding=&quot;0&quot;&gt;<br /><br />      &lt;tr&gt;<br />        &lt;td&gt;&lt;span class=&quot;style7&quot;&gt;コメント&lt;/span&gt;&lt;/td&gt;<br />      &lt;/tr&gt;<br />      &lt;tr&gt;<br />        &lt;td class=&quot;style4&quot;&gt;&lt;?php echo &#36;_SESSION[&quot;place5&quot;]; ?&gt;&lt;/td&gt;<br />      &lt;/tr&gt;<br />    &lt;/table&gt;<br />    &lt;p&gt;&lt;input type=&quot;submit&quot; name=&quot;confirm_add&quot; id=&quot;add&quot; value=&quot;送信&quot; /&gt;<br />        &lt;input type=&quot;submit&quot; name=&quot;back&quot; id=&quot;back&quot; value=&quot;戻る&quot; /&gt;  <br />    <br />&lt;/p&gt;<br />    <br />    &lt;/form&gt;<br />         &lt;/div&gt;<br /><br />    &lt;div align=&quot;center&quot;&gt;&lt;/div&gt;&lt;/td&gt;<br />  &lt;/tr&gt;<br />  &lt;tr&gt;<br />    &lt;td&gt;&amp;nbsp;&lt;/td&gt;<br />  &lt;/tr&gt;<br />&lt;/table&gt;<br />&lt;/body&gt;<br />&lt;/html&gt;<br /><br /><br /><br />/////////////////////////////////////////////////////////////////////<br /><br /><br />③ mail1_result.html<br /><br /><br /><br />&lt;?php<br />session_start();<br />if(isset(&#36;_POST))<br />&#123;<br />	if(isset(&#36;_POST[&quot;confirm_add&quot;]))<br />	&#123;<br />		header(&quot;location: mail1_result.html&quot;);<br />	&#125;<br />	if(isset(&#36;_POST[&quot;back&quot;]))<br />	&#123;<br />		header(&quot;location: mail1.html&quot;);<br />	&#125;<br />&#125;<br /><br />?&gt;<br /><br /><br />&lt;!DOCTYPE html PUBLIC &quot;-//W3C//DTD XHTML 1.0 Transitional//EN&quot; &quot;http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd&quot;&gt;<br />&lt;html xmlns=&quot;http://www.w3.org/1999/xhtml&quot;&gt;<br />&lt;head&gt;<br />&lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=utf-8&quot; /&gt;<br /><br />&lt;title&gt;フォーム&lt;/title&gt;<br /><br /><br />&lt;/head&gt;<br /><br /><br />&lt;body&gt;<br />&lt;table width=&quot;100&quot; border=&quot;0&quot; cellspacing=&quot;0&quot; cellpadding=&quot;0&quot;&gt;<br />  &lt;tr&gt;<br />    &lt;td&gt;&lt;img src=&quot;img/top.gif&quot; width=&quot;584&quot; height=&quot;43&quot; /&gt;&lt;/td&gt;<br />  &lt;/tr&gt;<br />  &lt;tr&gt;<br />    &lt;td background=&quot;img/bg.gif&quot;&gt;<br />    <br />    &lt;div style=&quot;padding:0px 30px 0px 40px&quot;&gt;<br />    <br />    <br />    &lt;p align=&quot;right&quot; class=&quot;style4&quot; style=&quot;margin-right:20px&quot;&gt;吉村紳一先生への相談フォーム&lt;/p&gt;<br />    &lt;table width=&quot;200&quot; border=&quot;0&quot; cellspacing=&quot;0&quot; cellpadding=&quot;0&quot;&gt;<br />      &lt;tr&gt;<br />        &lt;td width=&quot;2&quot; bgcolor=&quot;#175600&quot;&gt;&amp;nbsp;&lt;/td&gt;<br />        &lt;td style=&quot;padding:15px 0px 15px 10px&quot;&gt;&lt;span class=&quot;style9&quot;&gt;診察希望フォーム&lt;/span&gt;&lt;/td&gt;<br />      &lt;/tr&gt;<br />    &lt;/table&gt;<br />    &lt;p class=&quot;style1&quot;&gt;&lt;br /&gt;<br />    &lt;/p&gt;<br />  &lt;div align=&quot;left&quot; class=&quot;style10&quot; style=&quot;width:450px; margin-left:40px&quot;&gt;<br />            &lt;?php<br />			 if(isset(&#36;_GET[&quot;res&quot;]) &amp;&amp;  &#36;_GET[&quot;res&quot;])<br />			 	echo &quot;ありがとうございました。&quot;;<br />			 else<br />			 &#123;<br />			 	echo &quot;&lt;p&gt;メール送信エラー&lt;/p&gt;&quot;;<br />				echo &quot;&lt;p&gt;メール送信することができませんでした。お手数をおかけします。もう一度最初から入力をお願い致します。&lt;/p&gt;&quot;;<br />			 &#125;<br />			 ?&gt;<br />                                                        &lt;/div&gt;<br />        &lt;p&gt;&lt;/p&gt;<br />        &lt;table width=&quot;100%&quot; border=&quot;0&quot; cellspacing=&quot;0&quot; cellpadding=&quot;0&quot;&gt;<br />          &lt;tr&gt;<br />            &lt;td&gt;&lt;a href=&quot;javascript&#058;window.close();&quot; class=&quot;style4&quot;&gt;X 閉じる     &lt;/a&gt;&lt;/td&gt;<br />          &lt;/tr&gt;<br />        &lt;/table&gt;<br />        &lt;/div&gt;<br />    &lt;div align=&quot;center&quot;&gt;&lt;img src=&quot;img/bottontxt.gif&quot; width=&quot;513&quot; height=&quot;35&quot; /&gt;&lt;/div&gt;&lt;/td&gt;<br />  &lt;/tr&gt;<br />  &lt;tr&gt;<br />    &lt;td&gt;&lt;img src=&quot;img/bott.gif&quot; width=&quot;584&quot; height=&quot;40&quot; /&gt;&lt;/td&gt;<br />  &lt;/tr&gt;<br />&lt;/table&gt;<br />&lt;/body&gt;<br />&lt;/html&gt;<br /><br /><br />//////////////////////////////////////////////////////////<br /><br /><br />お願い、分かる方がいれば教えてください。 <img src="./templates/phpgrjp0.3/smilies/cry.gif" alt=":'(" /> <br /><br />問題は件名だけです。<br /><br /><br />宜しくお願いします。</div>
			</td>
		</tr>

		<tr class="tr2">
			<td class="postername">
				<div class="posternamecontainer"><a href="profile-246.html">nulla</a></div>
			</td>
			<td class="postinfo">
				<div class="postlinks"></div>
				<div class="postdate"><a href="topic-post528.html#post528" name="post528" rel="nofollow">#2</a> 2010 年 2 月 13 日(土) 11:17</div>
			</td>
		</tr>
		<tr class="tr2">
			<td class="posterinfo">
				会員
				<div class="avatar"></div>
				<div class="field">登録者: 8 2009</div>
				<div class="field">返信数: 103</div>
				<div class="field"></div>
			</td>
			<td class="postcontent">
				<div class="post">こんにちは、<br />ソースだけでは再現のしようがない場合があります。<br />os、phpのバージョン<br />などの環境を最低限提示してください。<br /><br />&gt; 件名だけはちゃんと日本語になりません。<br />何の件名でしょうか？<br />メールのSubjectですか？<br />メールのSubjectという話で進めます。<br />こちらの環境では「ホームページからのメッセージ」と表示されています。<br />つまり正常です。<br />”ちゃんと日本語になりません。”はどういう状態になるのですか？<br />肝心な情報がないと検証できません。<br />そもそもメールのSubjectの話なのか……<br /><br /><br /><br /># こちらもあえて検証した環境を伏せておきます。</div>
			</td>
		</tr>

		<tr class="tr1">
			<td class="postername">
				<div class="posternamecontainer"><a href="profile-303.html">criskeiichi</a></div>
			</td>
			<td class="postinfo">
				<div class="postlinks"></div>
				<div class="postdate"><a href="topic-post529.html#post529" name="post529" rel="nofollow">#3</a> 2010 年 2 月 13 日(土) 12:33</div>
			</td>
		</tr>
		<tr class="tr1">
			<td class="posterinfo">
				会員
				<div class="avatar"></div>
				<div class="field">登録者: 2 2010</div>
				<div class="field">返信数: 4</div>
				<div class="field"></div>
			</td>
			<td class="postcontent">
				<div class="post">nullaさん、返事ありがとうございます。<br />多分、使っているサーバーの問題かもしれませんが、<br />そのフォームから送信をすると”件名”だけ（SUBJECT）は<br />こんな感じで届きます：<br /><br />=?ISO-2022-JP?B?GyRCJVshPCVgJVohPCU4JCskaSROJWElQyU7ITwlOBsoQg==?= <br /><br />後は全部ちゃんと日本語になってます。<br />変更が出来る方法が無いでしょうか？ <img src="./templates/phpgrjp0.3/smilies/cry.gif" alt=":'(" /> <br /><br />宜しくお願いします</div>
			</td>
		</tr>

		<tr class="tr2">
			<td class="postername">
				<div class="posternamecontainer"><a href="profile-246.html">nulla</a></div>
			</td>
			<td class="postinfo">
				<div class="postlinks"></div>
				<div class="postdate"><a href="topic-post530.html#post530" name="post530" rel="nofollow">#4</a> 2010 年 2 月 13 日(土) 15:32</div>
			</td>
		</tr>
		<tr class="tr2">
			<td class="posterinfo">
				会員
				<div class="avatar"></div>
				<div class="field">登録者: 8 2009</div>
				<div class="field">返信数: 103</div>
				<div class="field"></div>
			</td>
			<td class="postcontent">
				<div class="post">○○というメーラを使っていて件名には○○と表示されてしまいます。<br />という情報に期待したのですが…。<br />お使いのメーラは何ですか？<br /><br />&gt; =?ISO-2022-JP?B?GyRCJVshPCVgJVohPCU4JCskaSROJWElQyU7ITwlOBsoQg==?=<br />そのメールのソースがこうなっているのなら正常です。<br />メーラで読み込んだときデコードされて「ホームページからのメッセージ」と表示されます。<br />というかこちらの環境では正常に表示されています。<br />今時Subjectをデコードできないメーラを使っているわけではないですよね？<br /><br />個人情報を伏せたメールのソースを提示してみてください。<br /><br /><br /><br />Subject: =?ISO-2022-JP?B?PT9JU08tMjAyMi1KUD9CP0d5UkNKVnNoUENWZ0pWb2hQQ1U0SkNza2FT?=<br /> =?ISO-2022-JP?B?Uk9KV0VsUXlVN0lUd2xPQnNvUWc9PT89?=<br /><br /><br /><span style="color:#efefef"><br /># 私の書き込みちゃんと読んでくれてるのかな？<br /># 予測と感で書き込むのはとても疲れます。<br /># ここの文章は余計でしたね。申し訳ありません。<br /></span><div class="editinfo">&laquo; 最終編集者 <a href="profile-246.html">nulla</a> 日時 2010 年 2 月 13 日(土) 15:51. &raquo;</div></div>
			</td>
		</tr>

		<tr class="tr1">
			<td class="postername">
				<div class="posternamecontainer"><a href="profile-246.html">nulla</a></div>
			</td>
			<td class="postinfo">
				<div class="postlinks"></div>
				<div class="postdate"><a href="topic-post531.html#post531" name="post531" rel="nofollow">#5</a> 2010 年 2 月 13 日(土) 15:42</div>
			</td>
		</tr>
		<tr class="tr1">
			<td class="posterinfo">
				会員
				<div class="avatar"></div>
				<div class="field">登録者: 8 2009</div>
				<div class="field">返信数: 103</div>
				<div class="field"></div>
			</td>
			<td class="postcontent">
				<div class="post">そういえばmbstring.func_overloadが設定されているとmail関数が自動的にマルチバイト関数に置き換わるような…。<br />&#36;subjectだけmb_encode_mimeheader()しないで送信したらどうなるでしょう？</div>
			</td>
		</tr>

		<tr class="tr2">
			<td class="postername">
				<div class="posternamecontainer"><a href="profile-246.html">nulla</a></div>
			</td>
			<td class="postinfo">
				<div class="postlinks"></div>
				<div class="postdate"><a href="topic-post532.html#post532" name="post532" rel="nofollow">#6</a> 2010 年 2 月 13 日(土) 16:06</div>
			</td>
		</tr>
		<tr class="tr2">
			<td class="posterinfo">
				会員
				<div class="avatar"></div>
				<div class="field">登録者: 8 2009</div>
				<div class="field">返信数: 103</div>
				<div class="field"></div>
			</td>
			<td class="postcontent">
				<div class="post">mbstring.func_overload = 1<br />件名が2回エンコードされる現象を再現できました。<br /><br />&#36;subjectはmb_convert_encoding()とmb_encode_mimeheader()しない。<br />&#36;bodyはmb_convert_encoding()しない。<br />mail関数ではなくmb_send_mail関数を使用する。<br /><br />これで大丈夫だと思いますが脆弱性が残っているので塞いでください。</div>
			</td>
		</tr>

		<tr class="tr1">
			<td class="postername">
				<div class="posternamecontainer"><a href="profile-303.html">criskeiichi</a></div>
			</td>
			<td class="postinfo">
				<div class="postlinks"></div>
				<div class="postdate"><a href="topic-post533.html#post533" name="post533" rel="nofollow">#7</a> 2010 年 2 月 13 日(土) 19:53</div>
			</td>
		</tr>
		<tr class="tr1">
			<td class="posterinfo">
				会員
				<div class="avatar"></div>
				<div class="field">登録者: 2 2010</div>
				<div class="field">返信数: 4</div>
				<div class="field"></div>
			</td>
			<td class="postcontent">
				<div class="post">nullaさん、返事ありがとうございました、<br /><br />さっきの言ったとうりにしましたが、SUBJECTとBODY(mailno内容）は文字化けになりました。<br />ちなみに、これを書きました。<br /><br />&quot;;<br />		<br />		&#36;_SESSION[&quot;name&quot;] = &quot;&quot;;<br />		&#36;_SESSION[&quot;email&quot;] = &quot;&quot;;        <br />		&#36;_SESSION[&quot;place5&quot;] = &quot;&quot;;                        <br /><br />		if(_mail(&#36;to, &#36;subject, &#36;body, &#36;from_email,&#36;from_name))<br />			header(&quot;location: mail1_result.html?res=1&quot;);<br />		else<br />			header(&quot;location: mail1_result.html?res=0&quot;);<br />					<br />	&#125;<br />	if(isset(&#36;_POST[&quot;back&quot;]))<br />	&#123;<br />		header(&quot;location: mail1.html&quot;);<br />	&#125;<br />&#125;<br /><br />function _mail(&#36;to, &#36;subject, &#36;body, &#36;from_email,&#36;from_name)<br />&#123;<br />    mb_language(&quot;ja&quot;);<br /> <br />    &#36;from_name = mb_convert_encoding(&#36;from_name, &quot;ISO-2022-JP&quot;,&quot;AUTO&quot;);<br />    &#36;from_name = mb_encode_mimeheader(&#36;from_name);<br /> <br />    &#36;headers  = &quot;MIME-Version: 1.0 \n&quot; ;<br />    &#36;headers .= &quot;From: &quot; .<br />           &quot;&quot;.&#36;from_name .&quot;&quot; .<br />           &quot;&lt;&quot;.&#36;from_email.&quot;&gt; \n&quot;;<br />    &#36;headers .= &quot;Reply-To: &quot; .<br />           &quot;&quot;.&#36;from_name .&quot;&quot; .<br />           &quot;&lt;&quot;.&#36;from_email.&quot;&gt; \n&quot;;<br />   <br />    &#36;headers .= &quot;Content-Type: text/plain;charset=ISO-2022-JP \n&quot;;<br />    &#36;sendmail_params  = &quot;-f&#36;from_email&quot;;<br />    &#36;result = mb_send_mail(&#36;to, &#36;subject, &#36;body, &#36;headers, &#36;sendmail_params);<br />    return &#36;result;<br />&#125;<br /><br />?&gt;</div>
			</td>
		</tr>

		<tr class="tr2">
			<td class="postername">
				<div class="posternamecontainer"><a href="profile-246.html">nulla</a></div>
			</td>
			<td class="postinfo">
				<div class="postlinks"></div>
				<div class="postdate"><a href="topic-post534.html#post534" name="post534" rel="nofollow">#8</a> 2010 年 2 月 15 日(月) 8:49</div>
			</td>
		</tr>
		<tr class="tr2">
			<td class="posterinfo">
				会員
				<div class="avatar"></div>
				<div class="field">登録者: 8 2009</div>
				<div class="field">返信数: 103</div>
				<div class="field"></div>
			</td>
			<td class="postcontent">
				<div class="post">おはようございます。<br /><br />こちらではこのように変更しました。<br /><br />&quot;;<br />		<br />		&#36;_SESSION[&quot;name&quot;] = &quot;&quot;;<br />		&#36;_SESSION[&quot;email&quot;] = &quot;&quot;;        <br />		&#36;_SESSION[&quot;place5&quot;] = &quot;&quot;;                        <br /><br />		if(_mail(&#36;to, &#36;subject, &#36;body, &#36;from_email,&#36;from_name))<br />			header(&quot;location: mail1_result.php?res=1&quot;);<br />		else<br />			header(&quot;location: mail1_result.php?res=0&quot;);<br />					<br />	&#125;<br />	if(isset(&#36;_POST[&quot;back&quot;]))<br />	&#123;<br />		header(&quot;location: mail1.php&quot;);<br />	&#125;<br />&#125;<br /><br />function _mail(&#36;to, &#36;subject, &#36;body, &#36;from_email,&#36;from_name)<br />&#123;<br />    mb_language(&quot;ja&quot;);<br />//    &#36;subject = mb_convert_encoding(&#36;subject, &quot;ISO-2022-JP&quot;,&quot;AUTO&quot;);<br />//    &#36;subject = mb_encode_mimeheader(&#36;subject);<br /> <br />    &#36;from_name = mb_convert_encoding(&#36;from_name, &quot;ISO-2022-JP&quot;,&quot;AUTO&quot;);<br />    &#36;from_name = mb_encode_mimeheader(&#36;from_name);<br /> <br />    &#36;headers  = &quot;MIME-Version: 1.0 \n&quot; ;<br />    &#36;headers .= &quot;From: &quot; .<br />           &quot;&quot;.&#36;from_name .&quot;&quot; .<br />           &quot;&lt;&quot;.&#36;from_email.&quot;&gt; \n&quot;;<br />    &#36;headers .= &quot;Reply-To: &quot; .<br />           &quot;&quot;.&#36;from_name .&quot;&quot; .<br />           &quot;&lt;&quot;.&#36;from_email.&quot;&gt; \n&quot;;<br />   <br />    &#36;headers .= &quot;Content-Type: text/plain;charset=ISO-2022-JP \n&quot;;<br />//    &#36;body = mb_convert_encoding(&#36;body, &quot;ISO-2022-JP&quot;,&quot;AUTO&quot;);<br />    &#36;sendmail_params  = &quot;-f&#36;from_email&quot;;<br />    &#36;result = mb_send_mail(&#36;to, &#36;subject, &#36;body, &#36;headers, &#36;sendmail_params);<br />//    &#36;result = mail(&#36;to, &#36;subject, &#36;body, &#36;headers, &#36;sendmail_params);<br />    return &#36;result;<br />&#125;<br /><br />?&gt;<br /><br /><br />やはり環境がわからないと予測と感を駆使しても無理ですね。<br />ちなみにこちらの環境は<br />*server<br />CentOS 5.4<br />Apache-2.2.3<br />php-5.2.10(cgi)<br /><br />php.iniマルチバイト関係抜粋<br />[mbstring]<br />mbstring.language = Japanese<br />mbstring.internal_encoding = utf-8<br />mbstring.http_input = pass<br />mbstring.http_output = pass<br />mbstring.encoding_translation = Off<br />mbstring.detect_order = utf-8,sjis,euc-jp,jis,ascii<br /><br />*client<br />Mozilla Thunderbird-3.0.1<br /><br />この環境では最初のソースで正常動作します。<br /><br /><br />php.iniにmbstring.func_overload = 1<br />を追記するとこの記事のソースで正常です。<br />（拡張子htmlでphpを動作するようになっていないので拡張子はphpにしてます）<br /><br /><span style="color:#efefef"># 単に「文字化けになりました」と書かれてもこちらには何も伝わりません。<br /># 回答者は質問者の環境や不具合の具体的な内容を知らなければ答えようがないということを理解してください。<br /># ご使用の環境を提示されない限り私からの回答はこれが最後になります。</span></div>
			</td>
		</tr>

		<tr class="tr1">
			<td class="postername">
				<div class="posternamecontainer"><a href="profile-303.html">criskeiichi</a></div>
			</td>
			<td class="postinfo">
				<div class="postlinks"></div>
				<div class="postdate"><a href="topic-post540.html#post540" name="post540" rel="nofollow">#9</a> 2010 年 2 月 16 日(火) 10:23</div>
			</td>
		</tr>
		<tr class="tr1">
			<td class="posterinfo">
				会員
				<div class="avatar"></div>
				<div class="field">登録者: 2 2010</div>
				<div class="field">返信数: 4</div>
				<div class="field"></div>
			</td>
			<td class="postcontent">
				<div class="post">nullaさん、メッセージありがとうございます。<br />nullaさんが書いたとおりでファイルを変更しました（copy-paste）が、<br />今回これで件名と中身（body）も文字化けになってしまいました。<br />私は普通のウェブデザイナーで、システムが分からなくて、後、サーバーにあるphp.iniとかHTACCSESSをなぶる事が出来ませんので、ただ上に書いたコードで直さないといけない。<br />本当にありがとう、でもやぱりこの状態で直す方法が無いみたいね。</div>
			</td>
		</tr>

		<tr class="tr2">
			<td class="postername">
				<div class="posternamecontainer"><a href="profile-246.html">nulla</a></div>
			</td>
			<td class="postinfo">
				<div class="postlinks"></div>
				<div class="postdate"><a href="topic-post542.html#post542" name="post542" rel="nofollow">#10</a> 2010 年 2 月 16 日(火) 12:44</div>
			</td>
		</tr>
		<tr class="tr2">
			<td class="posterinfo">
				会員
				<div class="avatar"></div>
				<div class="field">登録者: 8 2009</div>
				<div class="field">返信数: 103</div>
				<div class="field"></div>
			</td>
			<td class="postcontent">
				<div class="post">こんにちは、<br /><br />環境を知る方法はいくらでもあります。<br />あなたの依頼人？に聞くとか下記のソースなど。<br /><br />&lt;?php<br />	phpinfo();<br />?&gt;<br /><br />最近のデザイナは環境を知らされずに作成させられるのでしょうか…。<br /><br /><span style="color:#efefef"># なんとかの情けというやつです。</span></div>
			</td>
		</tr>

	</table>
	<p id="toolbarbottom"> </p>
	<p id="pagelinksbottom">ページ: 1</p>
	<div id="bottomfix"></div>
	<p id="actionlinks"></p>

	<p class="locationbar">
		&bull; <a href="index.html">日本PHPユーザ会 掲示板</a> &raquo; <a href="forum-2.html">PHP事はじめ</a> &raquo; 助けてください！
	</p>
	
	<p id="linkbar">
	</p>
	
	
	
	
	<p id="bottom">
		日本PHPユーザ会 掲示板 は <a href="http://www.usebb.net">UseBB 1 フォーラムソフトウェア</a> を使用しています
	</p>
	<div id="bottom-shadow"></div>
	
	</div>
	</div>
	</div>
</body>
</html>