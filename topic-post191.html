<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="ja" lang="ja" dir="ltr">
<head>
	<title>日本PHPユーザ会 掲示板: PHP 5 &raquo; mb_substitute_characterをlongにしたときの変換不能文字の取り扱い？</title>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
	<meta name="description" content="日本PHPユーザ会運営の掲示板です。※ただいまテスト運用中です。" />
	<meta name="keywords" content="php,web,php.gr.jp,community,usebb" />
	<link rel="stylesheet" type="text/css" href="./templates/phpgrjp0.3/styles.css" />
	<link rel="shortcut icon" href="./templates/phpgrjp0.3/gfx/usebb.ico" />
	<link rel="alternate" type="application/rss+xml" title="日本PHPユーザ会 掲示板 RSS フィード" href="rss.xml" />
	<script type="text/javascript" src="sources/javascript.js"></script>
</head>
<body onload="javascript:init_external()">
	<div id="pagebox-bg">
	<div id="shadow-left">
	<div id="shadow-right">
	
	<p id="logo"><a href="index.html"><img src="./templates/phpgrjp0.3/gfx/usebb.png" alt="UseBB" title="ホーム" /></a></p>
	<h1 id="boardname"><span id="line">日本PHPユーザ会 掲示板</span></h1>
	<h2 id="boarddescr">日本PHPユーザ会運営の掲示板です。※ただいまテスト運用中です。</h2>
	
	<div id="topmenu"><ul>
		<li><a href="index.html">ホーム</a></li><li><a href="faq.html">FAQ</a></li><li><a href="active.html">活発なトピック</a></li>
	</ul></div>
	<div id="topmenu-shadow"></div>
	
	<p class="locationbar">
		&bull; <a href="index.html">日本PHPユーザ会 掲示板</a> &raquo; <a href="forum-4.html">PHP 5</a> &raquo; mb_substitute_characterをlongにしたときの変換不能文字の取り扱い？
	</p>

	<h3 id="forumname"><a href="topic-73.html">mb_substitute_characterをlongにしたときの変換不能文字の取り扱い？</a></h3>
	<p id="forummods"></p>
	<p id="toolbartop"> </p>
	<p id="pagelinkstop">ページ: 1</p>
	<table class="maintable">
		<tr>
			<th>投稿者</th>
			<th>投稿</th>
		</tr>

		<tr class="tr1">
			<td class="postername">
				<div class="posternamecontainer"><a href="profile-61.html">kinta</a></div>
			</td>
			<td class="postinfo">
				<div class="postlinks"></div>
				<div class="postdate"><a href="topic-post183.html#post183" name="post183" rel="nofollow">#1</a> 2008 年 6 月 21 日(土) 7:59</div>
			</td>
		</tr>
		<tr class="tr1">
			<td class="posterinfo">
				会員
				<div class="avatar"></div>
				<div class="field">登録者: 1 2008</div>
				<div class="field">返信数: 2</div>
				<div class="field"></div>
			</td>
			<td class="postcontent">
				<div class="post">現在php5.1.6の環境(レンタル・サーバとローカルwin+ap2）で色々とテストを行っている、ｐｈｐ初心者です。<br /><br />早速、質問です。<br /><br />mb_substitute_characterやmbstring.substitute_character<br />で&quot;long&quot;指定をしたときに返ってくる結果について知りたいのです。<br />「php マニュアル(chm)」には「例: U+3000,JIS+7E7E」としか記載されていません。<br />自分で調べた範囲では・・・<br />　　U+,JIS+,JIS2+,W932+,I8859_1+,BAD+,?+<br />が有る様なんですが？？そこで質問です。<br /><br />１．各「+」の後に続くHexの桁数が知りたい。<br />　　例にも有るように「U+3000,JIS+7E7E」の様に<br />　　Hex４桁で固定と考えれば良いのでしょうか？<br />２．「U+やW932+やBAD+」などが現れる組み合わせを知りたい。<br />　　現在iModeを想定しているので、以下の組み合わせを使っていますが<br />　　　　mbstring.http_input &quot;ASCII,SJIS-win&quot;<br />　　　　mbstring.http_output &quot;SJIS-win&quot;<br />　　　　mbstring.internal_encoding &quot;eucJP-win&quot;<br />　　これだと実験の限りでは「W932+xxxx」しか出てきません。<br />　　他の組み合わせも実験したいのですが私の知識と環境では・・・<br />３．上記環境でSJISのFC4C（xxx.php?Text=%FC%4C）を与えたのですが<br />　　「W932+972D」と成りました。<br />　　FC4Cが何故に972Dに成るのでしょうか？<br /><br />以上、ご存知の方。ご指導願います。</div>
			</td>
		</tr>

		<tr class="tr2">
			<td class="postername">
				<div class="posternamecontainer"><a href="profile-36.html">kona@m</a></div>
			</td>
			<td class="postinfo">
				<div class="postlinks"></div>
				<div class="postdate"><a href="topic-post185.html#post185" name="post185" rel="nofollow">#2</a> 2008 年 6 月 22 日(日) 22:44</div>
			</td>
		</tr>
		<tr class="tr2">
			<td class="posterinfo">
				会員
				<div class="avatar"></div>
				<div class="field">登録者: 10 2007</div>
				<div class="field">返信数: 71</div>
				<div class="field"></div>
			</td>
			<td class="postcontent">
				<div class="post">私も詳しいことは分からないのですが、とりあえず試してみました。<br />ここに書かれているmbstringの設定をコピーして%FC%4Cを与えてみたところ、「W932+972D」になりました。<br />さらにmbstring.encoding_translationを<strong>On</strong>から<strong>Off</strong>にしてみたところ、「BAD+FC4C」になってきました。<br />残念ながらこれ以上はちょっとわかりませんでした。<br /><br />余計なお世話かもしれませんが、MSIMEのIMEパッドで探してみたところ、シフトJISのFC4Cは文字が定義されていないようでしたが、シフトJISのFC4BとJISの972Cが同じ字になっています。<br />この場合だと、%FC%4Cの文字エンコーディング変換でシフトJISから日本語EUCに変換する際に、に存在しない文字？が来てしまったということですから、結局一体どんな動作をするのでしょうね・・・。</div>
			</td>
		</tr>

		<tr class="tr1">
			<td class="postername">
				<div class="posternamecontainer"><a href="profile-61.html">kinta</a></div>
			</td>
			<td class="postinfo">
				<div class="postlinks"></div>
				<div class="postdate"><a href="topic-post191.html#post191" name="post191" rel="nofollow">#3</a> 2008 年 6 月 24 日(火) 21:00</div>
			</td>
		</tr>
		<tr class="tr1">
			<td class="posterinfo">
				会員
				<div class="avatar"></div>
				<div class="field">登録者: 1 2008</div>
				<div class="field">返信数: 2</div>
				<div class="field"></div>
			</td>
			<td class="postcontent">
				<div class="post">kona@mさん、有り難う御座います。<br />昨夜は都合で掲示板確認できませんでした。<br />ご返事、有り難う御座います。<br /><br />&gt;&gt;シフトJISのFC4Cは文字が定義されていないようでしたが<br />はい。あえてエラーになるように「%FC%4C」を使いました。<br /><br />mbstring.encoding_translationは携帯等のSJIS設定の記載に従いOnにしていました。<br />Offで「BAD+」に成ることは確認していませんでした(^_^<img src="./templates/phpgrjp0.3/smilies/wink.gif" alt=";)" /><br /><br />「.htaccess」の具体的な記載は以下の通りです。<br />php_value default_charset               &quot;Shift_JIS&quot;<br />php_value output_buffering              &quot;1&quot;<br />php_value output_handler                &quot;mb_output_handler&quot;<br />php_value mbstring.func_overload        0<br />php_value mbstring.detect_order         &quot;auto&quot;<br />php_flag  mbstring.encoding_translation On<br />php_value mbstring.http_input           &quot;ASCII,SJIS-win&quot;<br />php_value mbstring.http_output          &quot;SJIS-win&quot;<br />php_value mbstring.internal_encoding    &quot;eucJP-win&quot;<br />php_value mbstring.language             &quot;Japanese&quot;<br />php_value mbstring.substitute_character &quot;long&quot;<br /><br />変換不能をmb_ereg(_replace)する為にHex４桁で引っ掛ければ良いのかが疑問でした。<br />また､解るので在れば「U+やW932+やBAD+」が現れる組み合わせが知りたかったのです。<br />その全てをmb_ereg(_replace)しても構わないのですがHexの桁数が解らないと<br />「W932+xxxx1234」の様に変換不能文字の後に有効な文字「１２３４」が続くと<br />有効な文字まで取り込んで代替してしまう可能性があるので・・・質問しました。<br /><br />また、「%FC%4C」が「W932+972D」に成ることは特に現時点では問題無いのですが<br />ゆくゆく何らかの変換テーブルでも作る段階になった時に理由を知っておいたほうが良いと思い<br />質問しました。<br /><br />皆さん、宜しくお願いします。</div>
			</td>
		</tr>

	</table>
	<p id="toolbarbottom"> </p>
	<p id="pagelinksbottom">ページ: 1</p>
	<div id="bottomfix"></div>
	<p id="actionlinks"></p>

	<p class="locationbar">
		&bull; <a href="index.html">日本PHPユーザ会 掲示板</a> &raquo; <a href="forum-4.html">PHP 5</a> &raquo; mb_substitute_characterをlongにしたときの変換不能文字の取り扱い？
	</p>
	
	<p id="linkbar">
	</p>
	
	
	
	
	<p id="bottom">
		日本PHPユーザ会 掲示板 は <a href="http://www.usebb.net">UseBB 1 フォーラムソフトウェア</a> を使用しています
	</p>
	<div id="bottom-shadow"></div>
	
	</div>
	</div>
	</div>
</body>
</html>